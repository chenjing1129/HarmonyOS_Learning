@Entry
@Component
struct ExplictAnimationPage {
  @State isMoved: boolean = false
  @State heartScale: number = 1.0
  @State rotateAngle: number = 0
  private heartBeatTimer: number = -1

  aboutToAppear() {
    // å¯åŠ¨å¿ƒè·³å®šæ—¶å™¨ï¼Œæ¯800msè§¦å‘ä¸€æ¬¡çŠ¶æ€å˜åŒ–
    this.heartBeatTimer = setInterval(() => {
      this.heartScale = this.heartScale === 1.0 ? 1.2 : 1.0
      this.rotateAngle = this.rotateAngle + 90 // æ¯æ¬¡æ—‹è½¬90åº¦
    }, 800)
  }

  aboutToDisappear() {
    // æ¸…ç†å®šæ—¶å™¨ï¼Œé¿å…å†…å­˜æ³„æ¼
    if (this.heartBeatTimer !== -1) {
      clearInterval(this.heartBeatTimer)
    }
  }

  build() {
    Navigation() {
      Column({ space: 30 }) {
        Text('æ˜¾å¼åŠ¨ç”»æ¼”ç¤º')
          .fontSize(24)
          .fontWeight(FontWeight.Bold)

        Button('æ”¹å˜ä½ç½®').onClick(() => {
          this.isMoved = !this.isMoved
        })

        Circle({ width: 60, height: 60})
          .fill("#ff4fa9a3")
          .translate({ x: this.isMoved ? 200 : 0, y: 0})
          .animation({
            duration: 1000,
            curve: Curve.Smooth
          })

        Rect({ width: 80, height: 50 })
          .fill(this.isMoved ? Color.Red : Color.Blue)
          .translate({ x: this.isMoved ? 100 : 0, y: 0 })
          .animation({
            duration: 800,
            curve: Curve.EaseInOut
          })
        
        Button('è§’åº¦å˜åŒ–')
          .rotate({ angle: this.rotateAngle })
          .animation({
            duration: 600,
            curve: Curve.Friction,
            iterations: -1,
            playMode: PlayMode.Normal,
            expectedFrameRateRange: {
              expected: 60,
              min: 30,
              max: 120
            }
          })

        // ç¾åŒ–çš„å¿ƒè„å›¾æ¡ˆ
        Text('ğŸ’–')
          .fontSize(50)
          .margin({ top: 20 })
          .scale({ x: this.heartScale, y: this.heartScale })
          .animation({
            duration: 600,
            curve: Curve.Friction,
            iterations: -1,
            playMode: PlayMode.Alternate,
            delay: 100,
            expectedFrameRateRange: {
              expected: 60,
              min: 30,
              max: 120
            }
          })
      }
      .alignItems(HorizontalAlign.Center)
      .padding(16)
    }
    .title('æ˜¾å¼åŠ¨ç”»')
    .titleMode(NavigationTitleMode.Mini)
    .hideBackButton(false)
    .navBarWidth('100%')
    .navBarPosition(NavBarPosition.Start)
  }
}